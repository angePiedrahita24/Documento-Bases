-- Crear tabla Edificio
CREATE TABLE Edificio (
    id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    nombre VARCHAR2(255) NOT NULL UNIQUE
);

-- Crear tabla Piso
CREATE TABLE Piso (
    id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    numeropiso NUMBER NOT NULL,
    idEdificio NUMBER NOT NULL,
    FOREIGN KEY (idEdificio) REFERENCES Edificio(id) ON DELETE CASCADE,
    UNIQUE (numeropiso, idEdificio)
);

-- Crear tabla Cafeteria
CREATE TABLE Cafeteria (
    id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    nombre VARCHAR2(255) NOT NULL UNIQUE,
    idPiso NUMBER NOT NULL,
    FOREIGN KEY (idPiso) REFERENCES Piso(id) ON DELETE CASCADE
);

-- Crear tabla Colaborador
CREATE TABLE Colaborador (
    id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    tipodocumento VARCHAR2(255) NOT NULL,
    numerodocumento NUMBER NOT NULL,
    nombre VARCHAR2(255) NOT NULL,
    vinculacion VARCHAR2(255) CHECK (vinculacion IN ('PLANTA', 'TEMPORAL')) NOT NULL,
    comision NUMBER DEFAULT 10 CHECK (comision BETWEEN 0 AND 100),
    UNIQUE (tipodocumento, numerodocumento)
);

-- Crear tabla Meta
CREATE TABLE Meta (
    id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    idColaborador NUMBER NOT NULL,
    idCafeteria NUMBER NOT NULL,
    fechameta DATE NOT NULL,
    valor_meta NUMBER DEFAULT 0 NOT NULL,
    valor_real NUMBER DEFAULT 0 NOT NULL,
    FOREIGN KEY (idColaborador) REFERENCES Colaborador(id) ON DELETE CASCADE,
    FOREIGN KEY (idCafeteria) REFERENCES Cafeteria(id) ON DELETE CASCADE,
    UNIQUE (idColaborador, idCafeteria, fechameta)
);
